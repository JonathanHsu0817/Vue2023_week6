import{_ as b,o as d,c as o,a as p,d as t,F as _,f as g,g as I,t as r,h as m,v as C}from"./index-0628d5fc.js";const{VITE_API_URL:i,VITE_API_PATH:u}={VITE_API_URL:"https://vue3-course-api.hexschool.io/",VITE_API_PATH:"blacknwhiterabbit",BASE_URL:"/Vue2023_week6/",MODE:"production",DEV:!1,PROD:!0},v={data(){return{products:[],productId:"",cart:{},loadingItem:""}},methods:{getCarts(){this.$http.get(`${i}/v2/api/${u}/cart`).then(e=>{this.cart=e.data.data})},updateCartItem(e){const a={product_id:e.product.id,qty:e.qty};this.loadingItem=e.id,this.$http.put(`${i}/v2/api/${u}/cart/${e.id}`,{data:a}).then(h=>{this.loadingItem="",this.getCarts()}).catch(h=>{alert(h.response.data.message),this.loadingItem=""})},deleteItem(e){this.loadingItem=e.id,this.$http.delete(`${i}/v2/api/${u}/cart/${e.id}`).then(a=>{this.loadingItem="",this.getCarts()}).catch(a=>{alert(a.response.data.message)})},deleteAllCarts(){this.$http.delete(`${i}/v2/api/${u}/carts`).then(e=>{this.getCarts()}).catch(e=>{alert(e.response.data.message)})}},mounted(){this.getCarts()}},x={class:"text-end"},f={class:"table align-middle"},y=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",null,"單價")])],-1),V=["disabled","onClick"],k={key:0,class:"fas fa-spinner fa-pulse"},A={class:"input-group input-group-sm"},$={class:"input-group mb-3"},E=["onUpdate:modelValue","disabled","onChange"],P=["value"],T={class:"text-end"},w=t("td",{colspan:"3",class:"text-end"},"總計",-1),D={class:"text-end"},U=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),q={class:"text-end text-success"};function B(e,a,h,L,l,c){return d(),o(_,null,[p(" 這是購物車頁面 "),t("div",x,[t("button",{class:"btn btn-outline-danger",type:"button",onClick:a[0]||(a[0]=(...s)=>c.deleteAllCarts&&c.deleteAllCarts(...s))},"清空購物車")]),t("table",f,[y,t("tbody",null,[l.cart.carts?(d(!0),o(_,{key:0},g(l.cart.carts,s=>(d(),o("tr",{key:s.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:s.id===l.loadingItem,onClick:n=>c.deleteItem(s)},[l.loadingItem===s.id?(d(),o("i",k)):I("",!0),p(" x ")],8,V)]),t("td",null,r(s.product.title),1),t("td",null,[t("div",A,[t("div",$,[m(t("select",{name:"",id:"",class:"form-control","onUpdate:modelValue":n=>s.qty=n,disabled:s.id===l.loadingItem,onChange:n=>c.updateCartItem(s)},[(d(),o(_,null,g(10,n=>t("option",{value:n,key:n},r(n),9,P)),64))],40,E),[[C,s.qty]])])])]),t("td",T,r(s.total),1)]))),128)):I("",!0)]),t("tfoot",null,[t("tr",null,[w,t("td",D,r(l.cart.total),1)]),t("tr",null,[U,t("td",q,r(l.cart.final_total),1)])])])],64)}const N=b(v,[["render",B]]);export{N as default};
